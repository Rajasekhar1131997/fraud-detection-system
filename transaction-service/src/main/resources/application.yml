server:
  port: 8080

spring:
  application:
    name: transaction-service
  datasource:
    url: ${DB_URL:jdbc:postgresql://localhost:5432/fraud_db}
    username: ${DB_USERNAME:fraud_user}
    password: ${DB_PASSWORD:fraud_password}
  jpa:
    open-in-view: false
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        format_sql: true
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
    listener:
      observation-enabled: true
    template:
      observation-enabled: true
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
      properties:
        spring:
          json:
            add:
              type:
                headers: false
    consumer:
      group-id: ${app.kafka.consumer-group}
      auto-offset-reset: earliest
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
      properties:
        spring:
          json:
            trusted:
              packages: com.frauddetection.transactionservice.event
            value:
              default:
                type: com.frauddetection.transactionservice.event.TransactionCreatedEvent
            use:
              type:
                headers: false

app:
  kafka:
    transactions-topic: ${KAFKA_TOPIC_TRANSACTIONS:transactions}
    consumer-group: ${KAFKA_CONSUMER_GROUP:transaction-service-group}
  security:
    jwt:
      secret: ${APP_SECURITY_JWT_SECRET:dev-only-change-this-jwt-secret-to-a-long-random-value-32chars}
      issuer: ${APP_SECURITY_JWT_ISSUER:transaction-service}
      ttl-minutes: ${APP_SECURITY_JWT_TTL_MINUTES:60}
    users:
      - username: ${APP_SECURITY_ADMIN_USERNAME:admin}
        password: ${APP_SECURITY_ADMIN_PASSWORD:admin-change-me}
        roles:
          - ADMIN
          - ANALYST
      - username: ${APP_SECURITY_ANALYST_USERNAME:analyst}
        password: ${APP_SECURITY_ANALYST_PASSWORD:analyst-change-me}
        roles:
          - ANALYST

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      probes:
        enabled: true
  metrics:
    tags:
      application: ${spring.application.name}
